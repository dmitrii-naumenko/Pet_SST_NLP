# Раннее выявление инцидентов транспорта с использованием аудиозаписей переговоров


Для реализации предлагается использовать звук переговоров. Задача состоит из двух частей: оработка речи и обработка естественного языка. Более подробно [Design Doc](https://github.com/dmitrii-naumenko/Pet_SST_NLP-repo.nosync/blob/main/Design%20doc.md)

Описание файлов проекта:

- notebooks/dataset_preporation.ipynb - подготовка датасетов (перевод на русский, текст в речь, разделение на ренировку и тест)
- notebooks/stt.ipynb - модели перевода речи в текст
- notebooks/* - остальные файлы решения в виде блокнотов
- data/disaster_tweets.csv - изначальный датасет с твитами и разметкой аварий
- data/dataset_1000_ru.csv - сокращенный датасет
- data/yandex_stt_valid.csv - валидационный датасет для SST модели Yandex
- data/train.csv, valid.csv, test.csv - сплитованный датасет
- data/speech - директория с аудиофайлами

Результаты метрики BLEU для STT на валидационном датасете:

- 0.64 - Yandex SpeechKit (online) - базовое значение очень хорошей модели
- **0.69** - Whisper large ofline - отличный результат (18.0с на итерацию)
- **0.69** - Whisper medium ofline - отличный результат (10.0с на итерацию)
- **0.67** - Whisper small ofline - отличный результат (3.0с на итерацию)
- **0.64** - Whisper base ofline - отличный результат (1.2с на итерацию)
- **0.57** - Vosk RU Small (offline) - хороший результат
- 0.49 - Vosk RU Large (offline) - больше не значит лучше, хотя может быть вызвано грязными данными

Результаты NLP части:

- Учитывая, что в пробной выборке нет дисбаланса классов, то для простоты использвоали метрику Accuracy
- Простые методы на основе мешка слов имеют точность 0.77
- Дообученный BERT - **0.83**. Для раскрытия возможностей модели нужно больше данных (для проверки концепции использовалось 600 строк)
- Значимо увеличить качество можно за счет хорошо подготовленных данных для обучения, используемых в реальной задаче. 

Итого в рамках проекта было сделано:

- подготовлен дизайн док
- продемонстрирован машинный перевод (yandex api)
- продемонстрирован синтез речи (yandex api)
- продемонстрировано распознавание речи, задача STT (offline)
- продемонстрированы методы обработки естественного языка в задаче классификации, часть NLP (offline)
- подготовлена методика сравнения моделей и проведены тесты

Что можно доделать/улучшить
- добавить в адио шум, рандомно изменить громкость, проверить как это повлияет на метрику
- Потом добавить нормализитор громкости, фильтр шума и выделение голоса, сравнить
  